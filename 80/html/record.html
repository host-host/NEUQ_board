<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NIT的投资</title>
    <style>
        .canvas-class {
          height:70vh;
          width: min(200vh, 150vw);
        }
      </style>
    <script src="/js/chart.js"></script>
</head>
<body>
    <h1>NIT的投资</h1>
<br>
    <div>
        <a href="/data/record.json">JSON格式数据</a>
    </div>
    <div class="canvas-class">
        <canvas id="profitChart"></canvas>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            fetch('/data/record.json')
            .then(response => response.json())
            .then(data => {
                const labels = [...new Set(data.map(record => record.date))];
                const profitData = labels.map(date => {
                    const record = data.find(record => record.date === date && record.type === '累计盈亏');
                    return record ? record.profit : 0;
                });
                const principalData = labels.map(date => {
                    const record = data.find(record => record.date === date && record.type === '本金');
                    return record ? record.profit : 0;
                });
                const feeData = labels.map(date => {
                    const record = data.find(record => record.date === date && record.type === '累计手续费');
                    return record ? record.profit : 0;
                });
                const ctx = document.getElementById('profitChart').getContext('2d');
                new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: labels,
                        datasets: [
                            {
                                label: '累计盈亏',
                                data: profitData,
                                borderColor: getRandomColor(),
                                display: false,
                                yAxisID: 'y-axis-2',
                                pointRadius: 1.5
                            },
                            {
                                label: '本金',
                                data: principalData,
                                borderColor: getRandomColor(),
                                yAxisID: 'y-axis-1',
                                pointRadius: 1.5
                            },
                            {
                                label: '累计手续费',
                                data: feeData,
                                borderColor: getRandomColor(),
                                yAxisID: 'y-axis-2',
                                pointRadius: 1.5
                            }
                        ]
                    },
                    options: {
                        scales: {
                            'y-axis-2':{
                                position: 'right',
                            },
                            'y-axis-1':{
                                position: 'left',
                                grid: {
                                    display: false
                                }
                            }
                        }
                    }
                });
            });
        });
        function getRandomColor() {
            const letters='0123456789ABCDEF';
            let color='#';
            for (let i=0; i<6;i++)
                color+=letters[Math.floor(Math.random() * 16)];
            return color;
        }
    </script>
</body>
</html>